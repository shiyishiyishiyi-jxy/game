<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>拼图小游戏</title>
    <style>
        #puzzle {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            grid-template-rows: repeat(3, 100px);
            gap: 5px;
            width: 310px;
            margin: 0 auto;
        }

        .puzzle-piece {
            width: 100px;
            height: 100px;
            background-image: url('https://via.placeholder.com/300');
            cursor: pointer;
        }

        .empty {
            background: none;
            cursor: default;
        }
    </style>
</head>

<body>
    <h1>拼图小游戏</h1>
    <div id="puzzle"></div>
    <button onclick="shufflePuzzle()">打乱拼图</button>

    <script>
        const puzzle = document.getElementById('puzzle');
        const pieceSize = 100;
        const rows = 3;
        const cols = 3;
        let emptyX = cols - 1;
        let emptyY = rows - 1;

        function createPuzzle() {
            for (let y = 0; y < rows; y++) {
                for (let x = 0; x < cols; x++) {
                    const piece = document.createElement('div');
                    piece.classList.add('puzzle-piece');
                    if (x === emptyX && y === emptyY) {
                        piece.classList.add('empty');
                    } else {
                        piece.style.backgroundPosition = `-${x * pieceSize}px -${y * pieceSize}px`;
                        piece.addEventListener('click', () => movePiece(x, y));
                    }
                    puzzle.appendChild(piece);
                }
            }
        }

        function movePiece(x, y) {
            if ((Math.abs(x - emptyX) === 1 && y === emptyY) || (Math.abs(y - emptyY) === 1 && x === emptyX)) {
                const pieces = Array.from(puzzle.children);
                const currentIndex = y * cols + x;
                const emptyIndex = emptyY * cols + emptyX;

                const temp = pieces[currentIndex].style.backgroundPosition;
                pieces[currentIndex].style.backgroundPosition = pieces[emptyIndex].style.backgroundPosition;
                pieces[emptyIndex].style.backgroundPosition = temp;

                pieces[currentIndex].classList.toggle('empty');
                pieces[emptyIndex].classList.toggle('empty');

                emptyX = x;
                emptyY = y;
            }
        }

        function shufflePuzzle() {
            const moves = 100;
            for (let i = 0; i < moves; i++) {
                const possibleMoves = [];
                if (emptyX > 0) possibleMoves.push({ x: emptyX - 1, y: emptyY });
                if (emptyX < cols - 1) possibleMoves.push({ x: emptyX + 1, y: emptyY });
                if (emptyY > 0) possibleMoves.push({ x: emptyX, y: emptyY - 1 });
                if (emptyY < rows - 1) possibleMoves.push({ x: emptyX, y: emptyY + 1 });

                const randomMove = possibleMoves[Math.floor(Math.random() * possibleMoves.length)];
                movePiece(randomMove.x, randomMove.y);
            }
        }

        createPuzzle();
    </script>
</body>

</html>
